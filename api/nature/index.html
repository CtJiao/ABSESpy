
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../model/">
      
      
        <link rel="next" href="../human/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.10">
    
    
      
        <title>nature - AB-SESpy</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.fad675c6.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#major-natural-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="AB-SESpy" class="md-header__button md-logo" aria-label="AB-SESpy" data-md-component="logo">
      
  <img src="https://songshgeo-picgo-1302043007.cos.ap-beijing.myqcloud.com/uPic/logo_abses.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AB-SESpy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              nature
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../None" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="/ch/" hreflang="ch" class="md-select__link">
              Chinese
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/absespy/ABSESpy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../wiki/paper/" class="md-tabs__link">
          
  
  Wiki

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tutorial/lessons/organize_model_structure/" class="md-tabs__link">
          
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../model/" class="md-tabs__link">
          
  
  API references

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="AB-SESpy" class="md-nav__button md-logo" aria-label="AB-SESpy" data-md-component="logo">
      
  <img src="https://songshgeo-picgo-1302043007.cos.ap-beijing.myqcloud.com/uPic/logo_abses.svg" alt="logo">

    </a>
    AB-SESpy
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/absespy/ABSESpy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Home
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AB-SESpy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2" >
        
          
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Features
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../features/architectural_elegance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architectural elegance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../features/time_control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Control real-world time
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../features/MoHuB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unveiling Human Decision Dynamics in SES Modeling
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../home/install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get start
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../home/dependencies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dependencies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../home/license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../home/acknowledge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acknowledge
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Wiki
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Wiki
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../wiki/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Paper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../wiki/about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Context of ABSESpy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../wiki/background/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Terms and definitions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lessons/organize_model_structure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Organize your model structure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lessons/time_control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Real-world SES modeling enhancements
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lessons/human_behavior_simulation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Advanced Human Behavior Simulation Framework
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API references
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API references
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Natural Modules
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Natural Modules
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="Page contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#major-natural-module" class="md-nav__link">
    <span class="md-ellipsis">
      Major natural module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.BaseNature" class="md-nav__link">
    <span class="md-ellipsis">
      BaseNature
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.BaseNature.major_layer" class="md-nav__link">
    <span class="md-ellipsis">
      major_layer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.BaseNature.total_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      total_bounds
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.BaseNature.create_agents_from_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      create_agents_from_gdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.BaseNature.create_module" class="md-nav__link">
    <span class="md-ellipsis">
      create_module()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natural-submodule" class="md-nav__link">
    <span class="md-ellipsis">
      Natural submodule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule" class="md-nav__link">
    <span class="md-ellipsis">
      PatchModule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.cell_properties" class="md-nav__link">
    <span class="md-ellipsis">
      cell_properties
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.attributes" class="md-nav__link">
    <span class="md-ellipsis">
      attributes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.file" class="md-nav__link">
    <span class="md-ellipsis">
      file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.shape2d" class="md-nav__link">
    <span class="md-ellipsis">
      shape2d
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.shape3d" class="md-nav__link">
    <span class="md-ellipsis">
      shape3d
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.array_cells" class="md-nav__link">
    <span class="md-ellipsis">
      array_cells
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.coords" class="md-nav__link">
    <span class="md-ellipsis">
      coords
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.from_resolution" class="md-nav__link">
    <span class="md-ellipsis">
      from_resolution()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.copy_layer" class="md-nav__link">
    <span class="md-ellipsis">
      copy_layer()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.from_file" class="md-nav__link">
    <span class="md-ellipsis">
      from_file()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.get_raster" class="md-nav__link">
    <span class="md-ellipsis">
      get_raster()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.dynamic_var" class="md-nav__link">
    <span class="md-ellipsis">
      dynamic_var()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.get_rasterio" class="md-nav__link">
    <span class="md-ellipsis">
      get_rasterio()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.geometric_cells" class="md-nav__link">
    <span class="md-ellipsis">
      geometric_cells()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.link_by_geometry" class="md-nav__link">
    <span class="md-ellipsis">
      link_by_geometry()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.batch_link_by_geometry" class="md-nav__link">
    <span class="md-ellipsis">
      batch_link_by_geometry()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.linked_attr" class="md-nav__link">
    <span class="md-ellipsis">
      linked_attr()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.get_xarray" class="md-nav__link">
    <span class="md-ellipsis">
      get_xarray()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.random_positions" class="md-nav__link">
    <span class="md-ellipsis">
      random_positions()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.has_agent" class="md-nav__link">
    <span class="md-ellipsis">
      has_agent()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.land_allotment" class="md-nav__link">
    <span class="md-ellipsis">
      land_allotment()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.move_agent" class="md-nav__link">
    <span class="md-ellipsis">
      move_agent()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../human/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Human Modules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../cells/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cells
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../agents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Actor (Agent)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../container/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Actors Container
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Actors Operation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../time/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time Control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../decisions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Decisions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="Page contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#major-natural-module" class="md-nav__link">
    <span class="md-ellipsis">
      Major natural module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.BaseNature" class="md-nav__link">
    <span class="md-ellipsis">
      BaseNature
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.BaseNature.major_layer" class="md-nav__link">
    <span class="md-ellipsis">
      major_layer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.BaseNature.total_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      total_bounds
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.BaseNature.create_agents_from_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      create_agents_from_gdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.BaseNature.create_module" class="md-nav__link">
    <span class="md-ellipsis">
      create_module()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natural-submodule" class="md-nav__link">
    <span class="md-ellipsis">
      Natural submodule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule" class="md-nav__link">
    <span class="md-ellipsis">
      PatchModule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.cell_properties" class="md-nav__link">
    <span class="md-ellipsis">
      cell_properties
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.attributes" class="md-nav__link">
    <span class="md-ellipsis">
      attributes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.file" class="md-nav__link">
    <span class="md-ellipsis">
      file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.shape2d" class="md-nav__link">
    <span class="md-ellipsis">
      shape2d
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.shape3d" class="md-nav__link">
    <span class="md-ellipsis">
      shape3d
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.array_cells" class="md-nav__link">
    <span class="md-ellipsis">
      array_cells
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.coords" class="md-nav__link">
    <span class="md-ellipsis">
      coords
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.from_resolution" class="md-nav__link">
    <span class="md-ellipsis">
      from_resolution()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.copy_layer" class="md-nav__link">
    <span class="md-ellipsis">
      copy_layer()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.from_file" class="md-nav__link">
    <span class="md-ellipsis">
      from_file()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.get_raster" class="md-nav__link">
    <span class="md-ellipsis">
      get_raster()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.dynamic_var" class="md-nav__link">
    <span class="md-ellipsis">
      dynamic_var()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.get_rasterio" class="md-nav__link">
    <span class="md-ellipsis">
      get_rasterio()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.geometric_cells" class="md-nav__link">
    <span class="md-ellipsis">
      geometric_cells()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.link_by_geometry" class="md-nav__link">
    <span class="md-ellipsis">
      link_by_geometry()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.batch_link_by_geometry" class="md-nav__link">
    <span class="md-ellipsis">
      batch_link_by_geometry()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.linked_attr" class="md-nav__link">
    <span class="md-ellipsis">
      linked_attr()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.get_xarray" class="md-nav__link">
    <span class="md-ellipsis">
      get_xarray()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.random_positions" class="md-nav__link">
    <span class="md-ellipsis">
      random_positions()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.has_agent" class="md-nav__link">
    <span class="md-ellipsis">
      has_agent()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.land_allotment" class="md-nav__link">
    <span class="md-ellipsis">
      land_allotment()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abses.nature.PatchModule.move_agent" class="md-nav__link">
    <span class="md-ellipsis">
      move_agent()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Natural Modules</h1>

<h3 id="major-natural-module">Major natural module<a class="headerlink" href="#major-natural-module" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<a id="abses.nature.BaseNature"></a>
  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="mesa_geo.GeoSpace">GeoSpace</span></code>, <code><span title="abses.modules.CompositeModule">CompositeModule</span></code></p>

  
      <p>The Base Nature Module.
Note:
    Look at <a href="../../features/architectural_elegance/">this tutorial</a> to understand the model structure.
    This is NOT a raster layer, but can be seen as a container of different raster layers.
    Users can create new raster layer (i.e., <code>PatchModule</code>) by <code>create_module</code> method.
    By default, an initialized ABSESpy model will init an instance of this <code>BaseNature</code> as <code>nature</code> module.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>major_layer</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="abses.nature.PatchModule" href="#abses.nature.PatchModule">PatchModule</a> | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The major layer of nature module. By default, it's the first layer that user created.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>total_bounds</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span> | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The spatial scope of the model's concern. By default, uses the major layer of this model.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>abses/nature.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;nature&quot;</span><span class="p">):</span>
    <span class="n">CompositeModule</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="n">crs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;crs&quot;</span><span class="p">,</span> <span class="n">CRS</span><span class="p">)</span>
    <span class="n">mg</span><span class="o">.</span><span class="n">GeoSpace</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_major_layer</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h2 id="abses.nature.BaseNature.major_layer" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">major_layer</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#abses.nature.BaseNature.major_layer" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">major_layer</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The major layer of nature module.
By default, it's the first layer that user created.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h2 id="abses.nature.BaseNature.total_bounds" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">total_bounds</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#abses.nature.BaseNature.total_bounds" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">total_bounds</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Total bounds. The spatial scope of the model's concern.
If None (by default), uses the major layer of this model.
Usually, the major layer is the first layer sub-module you created.</p>
  </div>

</div>




<div class="doc doc-object doc-function">




<h2 id="abses.nature.BaseNature.create_agents_from_gdf" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">create_agents_from_gdf</span>


<a href="#abses.nature.BaseNature.create_agents_from_gdf" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">create_agents_from_gdf</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="s1">&#39;Index&#39;</span><span class="p">,</span> <span class="n">agent_cls</span><span class="o">=</span><span class="n">Actor</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Create actors from a <code>geopandas.GeoDataFrame</code> object.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>gdf</code></td>
          <td>
                <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The <code>geopandas.GeoDataFrame</code> object to convert.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unique_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A column name, denotes which column will be converted to unique index of created geo-agents (Social-ecological system Actors).</p>
            </div>
          </td>
          <td>
                <code>&#39;Index&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>agent_cls</code></td>
          <td>
                <code>type[<a class="autorefs autorefs-internal" title="abses.actor.Actor" href="../agents/#abses.actor.Actor">Actor</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Agent class to create.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="abses.actor.Actor" href="../agents/#abses.actor.Actor">Actor</a></code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="abses.sequences.ActorsList" href="../sequences/#abses.sequences.ActorsList">ActorsList</a>[<a class="autorefs autorefs-internal" title="abses.actor.Actor" href="../agents/#abses.actor.Actor">Actor</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An <code>ActorsList</code> with all new created actors stored.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>abses/nature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_agents_from_gdf</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">gdf</span><span class="p">:</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">,</span>
    <span class="n">unique_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Index&quot;</span><span class="p">,</span>
    <span class="n">agent_cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Actor</span><span class="p">]</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ActorsList</span><span class="p">[</span><span class="n">Actor</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create actors from a `geopandas.GeoDataFrame` object.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        gdf:</span>
<span class="sd">            The `geopandas.GeoDataFrame` object to convert.</span>
<span class="sd">        unique_id:</span>
<span class="sd">            A column name, denotes which column will be converted to unique index of created geo-agents (Social-ecological system Actors).</span>
<span class="sd">        agent_cls:</span>
<span class="sd">            Agent class to create.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An `ActorsList` with all new created actors stored.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">creator</span> <span class="o">=</span> <span class="n">mg</span><span class="o">.</span><span class="n">AgentCreator</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">agent_class</span><span class="o">=</span><span class="n">agent_cls</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span>
    <span class="p">)</span>
    <span class="n">agents</span> <span class="o">=</span> <span class="n">creator</span><span class="o">.</span><span class="n">from_GeoDataFrame</span><span class="p">(</span><span class="n">gdf</span><span class="o">=</span><span class="n">gdf</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="n">unique_id</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">register_a_breed</span><span class="p">(</span><span class="n">agent_cls</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">agents</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ActorsList</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">objs</span><span class="o">=</span><span class="n">agents</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="abses.nature.BaseNature.create_module" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">create_module</span>


<a href="#abses.nature.BaseNature.create_module" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">create_module</span><span class="p">(</span><span class="n">module_class</span><span class="o">=</span><span class="n">PatchModule</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Creates a submodule of the raster layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>module_class</code></td>
          <td>
                <code><span title="abses.modules.Module">Module</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The custom module class.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="abses.nature.PatchModule" href="#abses.nature.PatchModule">PatchModule</a></code>
          </td>
        </tr>
        <tr>
          <td><code>how</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Class method to call when creating the new sub-module (raster layer). So far, there are three options:
    <code>from_resolution</code>: by selecting shape and resolution.
    <code>from_file</code>: by input of a geo-tiff dataset.
    <code>copy_layer</code>: by copying shape, resolution, bounds, crs, and coordinates of an existing submodule.
if None (by default), just simply create a sub-module without any custom methods (i.e., use the base class <code>PatchModule</code>).</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Any other arg passed to the creation method. See corresponding method of your how option from <code>PatchModule</code> class methods.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="abses.nature.PatchModule" href="#abses.nature.PatchModule">PatchModule</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the created new module.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>abses/nature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_module</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">module_class</span><span class="p">:</span> <span class="n">Module</span> <span class="o">=</span> <span class="n">PatchModule</span><span class="p">,</span>
    <span class="n">how</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PatchModule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a submodule of the raster layer.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        module_class:</span>
<span class="sd">            The custom module class.</span>
<span class="sd">        how:</span>
<span class="sd">            Class method to call when creating the new sub-module (raster layer). So far, there are three options:</span>
<span class="sd">                `from_resolution`: by selecting shape and resolution.</span>
<span class="sd">                `from_file`: by input of a geo-tiff dataset.</span>
<span class="sd">                `copy_layer`: by copying shape, resolution, bounds, crs, and coordinates of an existing submodule.</span>
<span class="sd">            if None (by default), just simply create a sub-module without any custom methods (i.e., use the base class `PatchModule`).</span>
<span class="sd">        **kwargs:</span>
<span class="sd">            Any other arg passed to the creation method. See corresponding method of your how option from `PatchModule` class methods.</span>

<span class="sd">    Returns:</span>
<span class="sd">        the created new module.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">module</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">create_module</span><span class="p">(</span><span class="n">module_class</span><span class="p">,</span> <span class="n">how</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># 如果是第一个创建的模块,则将其作为主要的图层</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">major_layer</span> <span class="o">=</span> <span class="n">module</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">module</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h3 id="natural-submodule">Natural submodule<a class="headerlink" href="#natural-submodule" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<a id="abses.nature.PatchModule"></a>
  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="abses.modules.Module">Module</span></code>, <code><span title="mesa_geo.RasterLayer">RasterLayer</span></code></p>

  
      <p>The spatial sub-module base class.
Inherit from this class to create a submodule. Look at <a href="../../features/architectural_elegance/">this tutorial</a> to understand the model structure. This is also a raster layer, inherited from the 'mesa-geo.RasterLayer' class, and can place agents.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>cell_properties</code></td>
          <td>
                <code>set[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The accessible attributes of cells stored in this layer. All <code>PatchCell</code> methods which are decorated by the decorator <code>raster_attribute</code> should be appeared here.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>attributes</code></td>
          <td>
                <code>set[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>All accessible attributes from this layer.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>file</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the module is created by reading a raster dataset, save the file path.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>shape2d</code></td>
          <td>
                <code><span title="mesa.space.Coordinate">Coordinate</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Raster shape in 2D (heigh, width).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>shape3d</code></td>
          <td>
                <code><span title="mesa.space.Coordinate">Coordinate</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Raster shape in 3D (1, heigh, width).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>abses/nature.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">Module</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="n">mg</span><span class="o">.</span><span class="n">RasterLayer</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_cells</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">layer</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h2 id="abses.nature.PatchModule.cell_properties" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">cell_properties</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#abses.nature.PatchModule.cell_properties" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">cell_properties</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The accessible attributes of cells stored in this layer. All <code>PatchCell</code> methods which are decorated by the decorator <code>raster_attribute</code> should be appeared here.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h2 id="abses.nature.PatchModule.attributes" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">attributes</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#abses.nature.PatchModule.attributes" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">attributes</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>All accessible attributes from this layer.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h2 id="abses.nature.PatchModule.file" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">file</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#abses.nature.PatchModule.file" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">file</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>If the module is created by reading a raster dataset, save the file path.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h2 id="abses.nature.PatchModule.shape2d" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">shape2d</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#abses.nature.PatchModule.shape2d" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">shape2d</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Raster shape in 2D (height, width).
This is useful when working with 2d <code>numpy.array</code>.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h2 id="abses.nature.PatchModule.shape3d" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">shape3d</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#abses.nature.PatchModule.shape3d" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">shape3d</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Raster shape in 3D (1, heigh, width).
This is useful when working with <code>rasterio</code> band.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h2 id="abses.nature.PatchModule.array_cells" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">array_cells</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#abses.nature.PatchModule.array_cells" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">array_cells</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Array type of the <code>PatchCell</code> stored in this module.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h2 id="abses.nature.PatchModule.coords" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">coords</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#abses.nature.PatchModule.coords" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">coords</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Coordinate system of the raster data.
This is useful when working with <code>xarray.DataArray</code>.</p>
  </div>

</div>




<div class="doc doc-object doc-function">




<h2 id="abses.nature.PatchModule.from_resolution" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">from_resolution</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#abses.nature.PatchModule.from_resolution" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">from_resolution</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">crs</span><span class="o">=</span><span class="n">CRS</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cell_cls</span><span class="o">=</span><span class="n">PatchCell</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Create a layer from resolution.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="abses.main.MainModel" href="../model/#abses.main.MainModel">MainModel</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ABSESpy Model that the new module belongs.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the new module. If None (by default), using lowercase of the '<strong>class</strong>.<strong>name</strong>'. E.g., class NewModule -&gt; newmodule.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>shape</code></td>
          <td>
                <code><span title="mesa.space.Coordinate">Coordinate</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array shape (height, width) of the new module. For example, if shape=(3, 5), it means the new module will store 15 cells.</p>
            </div>
          </td>
          <td>
                <code>(10, 10)</code>
          </td>
        </tr>
        <tr>
          <td><code>crs</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="pyproj.CRS">CRS</span> | str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Coordinate Reference Systems. If passing a string object, should be able to parsed by <code>pyproj</code>. By default, we use CRS = "epsg:4326".</p>
            </div>
          </td>
          <td>
                <code><span title="abses.nature.CRS">CRS</span></code>
          </td>
        </tr>
        <tr>
          <td><code>resolution</code></td>
          <td>
                <code><span title="numbers.Number">Number</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Spatial Resolution when creating the coordinates. By default 1, it means shape (3, 5) will generate coordinates like {y: [0, 1, 2], x: [0, 1, 2, 3, 4]}. Similar, when using resolution=0.1, it will be {y: [.0, .1, .2], x: [.0, .1, .2, .3, .4]}.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>cell_cls</code></td>
          <td>
                <code>type[<a class="autorefs autorefs-internal" title="abses.cells.PatchCell" href="../cells/#abses.cells.PatchCell">PatchCell</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Class type of <code>PatchCell</code> to create.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="abses.cells.PatchCell" href="../cells/#abses.cells.PatchCell">PatchCell</a></code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Self">Self</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A new instance of self ("PatchModule").</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>abses/nature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_resolution</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">MainModel</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">shape</span><span class="p">:</span> <span class="n">Coordinate</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="n">crs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pyproj</span><span class="o">.</span><span class="n">CRS</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">CRS</span><span class="p">,</span>
    <span class="n">resolution</span><span class="p">:</span> <span class="n">Number</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">cell_cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">PatchCell</span><span class="p">]</span> <span class="o">=</span> <span class="n">PatchCell</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a layer from resolution.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        model:</span>
<span class="sd">            ABSESpy Model that the new module belongs.</span>
<span class="sd">        name:</span>
<span class="sd">            Name of the new module. If None (by default), using lowercase of the &#39;__class__.__name__&#39;. E.g., class NewModule -&gt; newmodule.</span>
<span class="sd">        shape:</span>
<span class="sd">            Array shape (height, width) of the new module. For example, if shape=(3, 5), it means the new module will store 15 cells.</span>
<span class="sd">        crs:</span>
<span class="sd">            Coordinate Reference Systems. If passing a string object, should be able to parsed by `pyproj`. By default, we use CRS = &quot;epsg:4326&quot;.</span>
<span class="sd">        resolution:</span>
<span class="sd">            Spatial Resolution when creating the coordinates. By default 1, it means shape (3, 5) will generate coordinates like {y: [0, 1, 2], x: [0, 1, 2, 3, 4]}. Similar, when using resolution=0.1, it will be {y: [.0, .1, .2], x: [.0, .1, .2, .3, .4]}.</span>
<span class="sd">        cell_cls:</span>
<span class="sd">            Class type of `PatchCell` to create.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new instance of self (&quot;PatchModule&quot;).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">shape</span>
    <span class="n">total_bounds</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">width</span> <span class="o">*</span> <span class="n">resolution</span><span class="p">,</span> <span class="n">height</span> <span class="o">*</span> <span class="n">resolution</span><span class="p">]</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">total_bounds</span><span class="o">=</span><span class="n">total_bounds</span><span class="p">,</span>
        <span class="n">cell_cls</span><span class="o">=</span><span class="n">cell_cls</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="abses.nature.PatchModule.copy_layer" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">copy_layer</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#abses.nature.PatchModule.copy_layer" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">copy_layer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">layer</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cell_cls</span><span class="o">=</span><span class="n">PatchCell</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Copy an existing layer to create a new layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="abses.main.MainModel" href="../model/#abses.main.MainModel">MainModel</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ABSESpy Model that the new module belongs.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>layer</code></td>
          <td>
                <code><span title="typing.Self">Self</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Another layer to copy. These attributes will be copied: the coordinates, the crs, and the shape.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the new module. If None (by default), using lowercase of the '<strong>class</strong>.<strong>name</strong>'. E.g., class NewModule -&gt; newmodule.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>cell_cls</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="abses.cells.PatchCell" href="../cells/#abses.cells.PatchCell">PatchCell</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Class type of <code>PatchCell</code> to create.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="abses.cells.PatchCell" href="../cells/#abses.cells.PatchCell">PatchCell</a></code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Self">Self</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A new instance of self ("PatchModule").</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>abses/nature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">copy_layer</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">MainModel</span><span class="p">,</span>
    <span class="n">layer</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">cell_cls</span><span class="p">:</span> <span class="n">PatchCell</span> <span class="o">=</span> <span class="n">PatchCell</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Copy an existing layer to create a new layer.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        model:</span>
<span class="sd">            ABSESpy Model that the new module belongs.</span>
<span class="sd">        layer:</span>
<span class="sd">            Another layer to copy. These attributes will be copied: the coordinates, the crs, and the shape.</span>
<span class="sd">        name:</span>
<span class="sd">            Name of the new module. If None (by default), using lowercase of the &#39;__class__.__name__&#39;. E.g., class NewModule -&gt; newmodule.</span>
<span class="sd">        cell_cls:</span>
<span class="sd">            Class type of `PatchCell` to create.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new instance of self (&quot;PatchModule&quot;).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">PatchModule</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">layer</span><span class="si">}</span><span class="s2"> is not a valid PatchModule.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="n">layer</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="n">layer</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="n">layer</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">total_bounds</span><span class="o">=</span><span class="n">layer</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span>
        <span class="n">cell_cls</span><span class="o">=</span><span class="n">cell_cls</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="abses.nature.PatchModule.from_file" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">from_file</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#abses.nature.PatchModule.from_file" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">from_file</span><span class="p">(</span><span class="n">raster_file</span><span class="p">,</span> <span class="n">cell_cls</span><span class="o">=</span><span class="n">PatchCell</span><span class="p">,</span> <span class="n">attr_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Create a raster layer module from a file.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>raster_file</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>File path of a geo-tiff dataset.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>model</code></td>
          <td>
                <code>None | <a class="autorefs autorefs-internal" title="abses.main.MainModel" href="../model/#abses.main.MainModel">MainModel</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ABSESpy Model that the new module belongs.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>attr_name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Assign a attribute name to the loaded raster data.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the new module. If None (by default), using lowercase of the '<strong>class</strong>.<strong>name</strong>'. E.g., class NewModule -&gt; newmodule.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>cell_cls</code></td>
          <td>
                <code>type[<span title="mesa_geo.raster_layers.Cell">Cell</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Class type of <code>PatchCell</code> to create.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="abses.cells.PatchCell" href="../cells/#abses.cells.PatchCell">PatchCell</a></code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>abses/nature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">raster_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cell_cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">PatchCell</span><span class="p">,</span>
    <span class="n">attr_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">MainModel</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a raster layer module from a file.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        raster_file:</span>
<span class="sd">            File path of a geo-tiff dataset.</span>
<span class="sd">        model:</span>
<span class="sd">            ABSESpy Model that the new module belongs.</span>
<span class="sd">        attr_name:</span>
<span class="sd">            Assign a attribute name to the loaded raster data.</span>
<span class="sd">        name:</span>
<span class="sd">            Name of the new module. If None (by default), using lowercase of the &#39;__class__.__name__&#39;. E.g., class NewModule -&gt; newmodule.</span>
<span class="sd">        cell_cls:</span>
<span class="sd">            Class type of `PatchCell` to create.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">raster_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dataset</span><span class="p">:</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">total_bounds</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">dataset</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">left</span><span class="p">,</span>
            <span class="n">dataset</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">bottom</span><span class="p">,</span>
            <span class="n">dataset</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">right</span><span class="p">,</span>
            <span class="n">dataset</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">top</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">total_bounds</span><span class="o">=</span><span class="n">total_bounds</span><span class="p">,</span>
        <span class="n">cell_cls</span><span class="o">=</span><span class="n">cell_cls</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">_transform</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">transform</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="n">raster_file</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">apply_raster</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">attr_name</span><span class="o">=</span><span class="n">attr_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">obj</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="abses.nature.PatchModule.get_raster" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_raster</span>


<a href="#abses.nature.PatchModule.get_raster" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_raster</span><span class="p">(</span><span class="n">attr_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Obtaining the Raster layer by attribute.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>attr_name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The attribute to retrieve. Update it if it is a dynamic variable. If None (by default), retrieve all attributes as a 3D array.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A 3D array of attribute.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>abses/nature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_raster</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Obtaining the Raster layer by attribute.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        attr_name:</span>
<span class="sd">            The attribute to retrieve. Update it if it is a dynamic variable. If None (by default), retrieve all attributes as a 3D array.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A 3D array of attribute.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">attr_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_variables</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_raster</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_var</span><span class="p">(</span><span class="n">attr_name</span><span class="o">=</span><span class="n">attr_name</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape3d</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="abses.nature.PatchModule.dynamic_var" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">dynamic_var</span>


<a href="#abses.nature.PatchModule.dynamic_var" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">dynamic_var</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Update and get dynamic variable.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>attr_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The dynamic variable to retrieve.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D numpy.ndarray data of the variable.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>abses/nature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dynamic_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update and get dynamic variable.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        attr_name:</span>
<span class="sd">            The dynamic variable to retrieve.</span>

<span class="sd">    Returns:</span>
<span class="sd">        2D numpy.ndarray data of the variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">array</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">dynamic_var</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span>
    <span class="c1"># 判断算出来的是一个符合形状的矩阵</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_attr_or_array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
    <span class="c1"># 将矩阵转换为三维，并更新空间数据</span>
    <span class="n">array_3d</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape3d</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">apply_raster</span><span class="p">(</span><span class="n">array_3d</span><span class="p">,</span> <span class="n">attr_name</span><span class="o">=</span><span class="n">attr_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">array</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="abses.nature.PatchModule.get_rasterio" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_rasterio</span>


<a href="#abses.nature.PatchModule.get_rasterio" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_rasterio</span><span class="p">(</span><span class="n">attr_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Gets the Rasterio raster layer corresponding to the attribute. Save to a temporary rasterio memory file.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>attr_name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The attribute name for creating the rasterio file.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="rasterio.MemoryFile">MemoryFile</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The rasterio tmp memory file of raster.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>abses/nature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_rasterio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">rio</span><span class="o">.</span><span class="n">MemoryFile</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the Rasterio raster layer corresponding to the attribute. Save to a temporary rasterio memory file.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        attr_name:</span>
<span class="sd">            The attribute name for creating the rasterio file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The rasterio tmp memory file of raster.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_raster</span><span class="p">(</span><span class="n">attr_name</span><span class="o">=</span><span class="n">attr_name</span><span class="p">)</span>
    <span class="c1"># 如果获取到的是2维，重整为3维</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape3d</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">rio</span><span class="o">.</span><span class="n">MemoryFile</span><span class="p">()</span> <span class="k">as</span> <span class="n">mem_file</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">mem_file</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
            <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;GTiff&quot;</span><span class="p">,</span>
            <span class="n">height</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">width</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="n">count</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="c1"># number of bands</span>
            <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">dataset</span><span class="p">:</span>
            <span class="n">dataset</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="c1"># Open the dataset again for reading and return</span>
        <span class="k">return</span> <span class="n">mem_file</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="abses.nature.PatchModule.geometric_cells" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">geometric_cells</span>


<a href="#abses.nature.PatchModule.geometric_cells" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">geometric_cells</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Gets all the cells that intersect the given geometry.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>geometry</code></td>
          <td>
                <code><span title="shapely.Geometry">Geometry</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shapely Geometry to search intersected cells.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Args pass to the function <code>rasterio.mask.mask</code>. It influence how to build the mask for filtering cells. Please refer <a href="https://rasterio.readthedocs.io/en/latest/api/rasterio.mask.html">this doc</a> for details.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="abses.cells.PatchCell" href="../cells/#abses.cells.PatchCell">PatchCell</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of PatchCell.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>abses/nature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">geometric_cells</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">geometry</span><span class="p">:</span> <span class="n">Geometry</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">PatchCell</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets all the cells that intersect the given geometry.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        geometry:</span>
<span class="sd">            Shapely Geometry to search intersected cells.</span>
<span class="sd">        **kwargs:</span>
<span class="sd">            Args pass to the function `rasterio.mask.mask`. It influence how to build the mask for filtering cells. Please refer [this doc](https://rasterio.readthedocs.io/en/latest/api/rasterio.mask.html) for details.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of PatchCell.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rasterio</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attributes</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">out_image</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="n">geometry</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">mask_</span> <span class="o">=</span> <span class="n">out_image</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape2d</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_cells</span><span class="p">[</span><span class="n">mask_</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)])</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="abses.nature.PatchModule.link_by_geometry" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">link_by_geometry</span>


<a href="#abses.nature.PatchModule.link_by_geometry" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">link_by_geometry</span><span class="p">(</span><span class="n">geo_agent</span><span class="p">,</span> <span class="n">link</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Relates all cells intersecting a given geometry.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>geo_agent</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="abses.actor.Actor" href="../agents/#abses.actor.Actor">Actor</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An Actor who has geometry info.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>link</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The link info to save.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Args pass to the function <code>rasterio.mask.mask</code>. It influence how to build the mask for filtering cells. Please refer <a href="https://rasterio.readthedocs.io/en/latest/api/rasterio.mask.html">this doc</a> for details.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>abses/nature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">link_by_geometry</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">geo_agent</span><span class="p">:</span> <span class="n">Actor</span><span class="p">,</span> <span class="n">link</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Relates all cells intersecting a given geometry.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        geo_agent:</span>
<span class="sd">            An Actor who has geometry info.</span>
<span class="sd">        link:</span>
<span class="sd">            The link info to save.</span>
<span class="sd">        **kwargs:</span>
<span class="sd">            Args pass to the function `rasterio.mask.mask`. It influence how to build the mask for filtering cells. Please refer [this doc](https://rasterio.readthedocs.io/en/latest/api/rasterio.mask.html) for details.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">geo_agent</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Agent </span><span class="si">{</span><span class="n">geo_agent</span><span class="si">}</span><span class="s2"> has no geometry.&quot;</span><span class="p">)</span>
    <span class="n">cells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometric_cells</span><span class="p">(</span><span class="n">geo_agent</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">cells</span><span class="p">:</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">link_to</span><span class="p">(</span><span class="n">agent</span><span class="o">=</span><span class="n">geo_agent</span><span class="p">,</span> <span class="n">link</span><span class="o">=</span><span class="n">link</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="abses.nature.PatchModule.batch_link_by_geometry" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">batch_link_by_geometry</span>


<a href="#abses.nature.PatchModule.batch_link_by_geometry" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">batch_link_by_geometry</span><span class="p">(</span><span class="n">geo_agents</span><span class="p">,</span> <span class="n">link</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The batch will assign intersecting grids to the main body based on geometry.</p>

          <details class="quote">
            <summary>Source code in <code>abses/nature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">batch_link_by_geometry</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">geo_agents</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Actor</span><span class="p">],</span> <span class="n">link</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The batch will assign intersecting grids to the main body based on geometry.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">geo_agent</span> <span class="ow">in</span> <span class="n">geo_agents</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link_by_geometry</span><span class="p">(</span><span class="n">geo_agent</span><span class="p">,</span> <span class="n">link</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="abses.nature.PatchModule.linked_attr" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">linked_attr</span>


<a href="#abses.nature.PatchModule.linked_attr" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">linked_attr</span><span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="n">link</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nodata</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;only&#39;</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Gets the attribute linked to this layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>attr_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The attribute name to search.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>link</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The link name to get. If None (by default), get the actors located at each cell.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>nodata</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>On the cells without linked agent or located agent, return this nodata.</p>
            </div>
          </td>
          <td>
                <code><span title="numpy.nan">nan</span></code>
          </td>
        </tr>
        <tr>
          <td><code>how</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Search mode. Choose the behave when a cell is linked to or have more than one agent.
    If 'only', raises ABSESpyError when more than one agent is found.
    If 'random', random choose an agent from all searched agents.</p>
            </div>
          </td>
          <td>
                <code>&#39;only&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An array of searched attribute.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>abses/nature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">linked_attr</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">attr_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">link</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">nodata</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
    <span class="n">how</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;only&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the attribute linked to this layer.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        attr_name:</span>
<span class="sd">            The attribute name to search.</span>
<span class="sd">        link:</span>
<span class="sd">            The link name to get. If None (by default), get the actors located at each cell.</span>
<span class="sd">        nodata:</span>
<span class="sd">            On the cells without linked agent or located agent, return this nodata.</span>
<span class="sd">        how:</span>
<span class="sd">            Search mode. Choose the behave when a cell is linked to or have more than one agent.</span>
<span class="sd">                If &#39;only&#39;, raises ABSESpyError when more than one agent is found.</span>
<span class="sd">                If &#39;random&#39;, random choose an agent from all searched agents.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An array of searched attribute.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_attr</span><span class="p">(</span><span class="n">cell</span><span class="p">:</span> <span class="n">PatchCell</span><span class="p">,</span> <span class="n">__name</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cell</span><span class="o">.</span><span class="n">linked_attr</span><span class="p">(</span>
            <span class="n">attr</span><span class="o">=</span><span class="n">__name</span><span class="p">,</span>
            <span class="n">link</span><span class="o">=</span><span class="n">link</span><span class="p">,</span>
            <span class="n">nodata</span><span class="o">=</span><span class="n">nodata</span><span class="p">,</span>
            <span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">get_attr</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_cells</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="abses.nature.PatchModule.get_xarray" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_xarray</span>


<a href="#abses.nature.PatchModule.get_xarray" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_xarray</span><span class="p">(</span><span class="n">attr_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Get the xarray raster layer with spatial coordinates.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>attr_name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The attribute to retrieve. If None (by default), return all available attributes (3D DataArray). Otherwise, 2D DataArray of the chosen attribute.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.DataArray">DataArray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Xarray.DataArray data with spatial coordinates of the chosen attribute.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>abses/nature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_xarray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the xarray raster layer with spatial coordinates.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        attr_name:</span>
<span class="sd">            The attribute to retrieve. If None (by default), return all available attributes (3D DataArray). Otherwise, 2D DataArray of the chosen attribute.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Xarray.DataArray data with spatial coordinates of the chosen attribute.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_raster</span><span class="p">(</span><span class="n">attr_name</span><span class="o">=</span><span class="n">attr_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">attr_name</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">attr_name</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape2d</span><span class="p">)</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attributes</span><span class="p">)}</span>
        <span class="n">coords</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_crs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="abses.nature.PatchModule.random_positions" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">random_positions</span>


<a href="#abses.nature.PatchModule.random_positions" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">random_positions</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Choose 'k' <code>PatchCell</code> in the layer randomly.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>k</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>number of patches to choose.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>mask</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>bool mask, only True patches can be choose. If None, all patches are accessible. Defaults to None.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>prob</code></td>
          <td>
                <code>str | <span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>probability of each available position.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>replace</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If a patch can be chosen more than once. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.List">List</span>[<span title="mesa.space.Coordinate">Coordinate</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Iterable coordinates of chosen patches.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>abses/nature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">random_positions</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">where</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">prob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">replace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Coordinate</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Choose &#39;k&#39; `PatchCell` in the layer randomly.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        k:</span>
<span class="sd">            number of patches to choose.</span>
<span class="sd">        mask:</span>
<span class="sd">            bool mask, only True patches can be choose. If None, all patches are accessible. Defaults to None.</span>
<span class="sd">        prob:</span>
<span class="sd">            probability of each available position.</span>
<span class="sd">        replace:</span>
<span class="sd">            If a patch can be chosen more than once. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Iterable coordinates of chosen patches.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">where</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attr_or_array</span><span class="p">(</span><span class="n">where</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attr_or_array</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">masked_prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">where</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">norm_choice</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">array_cells</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
        <span class="n">size</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
        <span class="n">p</span><span class="o">=</span><span class="n">masked_prob</span><span class="p">,</span>
        <span class="n">replace</span><span class="o">=</span><span class="n">replace</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="abses.nature.PatchModule.has_agent" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">has_agent</span>


<a href="#abses.nature.PatchModule.has_agent" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">has_agent</span><span class="p">(</span><span class="n">link</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xarray</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>If any actor is linked or existed in each cell.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>link</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Link to search. If None (by default), search if any actor is located at in each cell.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>xarray</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, return <code>Xarray.DataArray</code> object, <code>np.ndarray</code> otherwise (by default).</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A raster data shows weather any actor links or exists.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>abses/nature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">has_agent</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">link</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xarray</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;If any actor is linked or existed in each cell.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        link:</span>
<span class="sd">            Link to search. If None (by default), search if any actor is located at in each cell.</span>
<span class="sd">        xarray:</span>
<span class="sd">            If True, return `Xarray.DataArray` object, `np.ndarray` otherwise (by default).</span>

<span class="sd">    Returns:</span>
<span class="sd">        A raster data shows weather any actor links or exists.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">link</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">has_agent</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_cells</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">linked</span><span class="p">(</span><span class="n">link</span><span class="p">)))(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_cells</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">xarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">coords</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">link</span> <span class="ow">or</span> <span class="s2">&quot;has_agent&quot;</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_crs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="abses.nature.PatchModule.land_allotment" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">land_allotment</span>


<a href="#abses.nature.PatchModule.land_allotment" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">land_allotment</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">link</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Allotment of land of this layer to actors.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>agent</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="abses.actor.Actor" href="../agents/#abses.actor.Actor">Actor</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the actor to Affirmation of land link.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>link</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>link name of the association.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>where</code></td>
          <td>
                <code>None | str | <span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if None, all cells will be selected.
if str, choose the corresponding attribute raster array as the mask.
if ndarray, the input array should has the same 2d-shape with this layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="abses.errors.ABSESpyError">ABSESpyError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the shape of input array is not aligned with the shape of this layer.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>abses/nature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">land_allotment</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">agent</span><span class="p">:</span> <span class="n">Actor</span><span class="p">,</span> <span class="n">link</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">where</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Allotment of land of this layer to actors.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        agent:</span>
<span class="sd">            the actor to Affirmation of land link.</span>
<span class="sd">        link:</span>
<span class="sd">            link name of the association.</span>
<span class="sd">        where:</span>
<span class="sd">            if None, all cells will be selected.</span>
<span class="sd">            if str, choose the corresponding attribute raster array as the mask.</span>
<span class="sd">            if ndarray, the input array should has the same 2d-shape with this layer.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ABSESpyError:</span>
<span class="sd">            If the shape of input array is not aligned with the shape of this layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mask_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attr_or_array</span><span class="p">(</span><span class="n">where</span><span class="p">)</span>
    <span class="n">cells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_cells</span><span class="p">[</span><span class="n">mask_</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">cells</span><span class="p">:</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">link_to</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">link</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="abses.nature.PatchModule.move_agent" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">move_agent</span>


<a href="#abses.nature.PatchModule.move_agent" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">move_agent</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">position</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Move an Actor to another position of this layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>agent</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="abses.actor.Actor" href="../agents/#abses.actor.Actor">Actor</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The actor to operate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>position</code></td>
          <td>
                <code><span title="mesa.space.Coordinate">Coordinate</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The position to put on.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="abses.errors.ABSESpyError">ABSESpyError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the agent is not located at this layer before moving.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>abses/nature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">move_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agent</span><span class="p">:</span> <span class="n">Actor</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Coordinate</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Move an Actor to another position of this layer.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        agent:</span>
<span class="sd">            The actor to operate.</span>
<span class="sd">        position:</span>
<span class="sd">            The position to put on.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ABSESpyError:</span>
<span class="sd">            If the agent is not located at this layer before moving.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">agent</span><span class="o">.</span><span class="n">layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ABSESpyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Agent </span><span class="si">{</span><span class="n">agent</span><span class="si">}</span><span class="s2"> is not on </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">put_on_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["header.autohide", "navigation.tabs", "navigation.tracking", "toc.follow", "content.tooltips"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": [{"provider": "mike"}]}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c14ae12.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>